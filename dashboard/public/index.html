<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Faye Control</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="sky-layer" aria-hidden="true"></div>

    <header class="hero">
      <p class="hero-kicker">OpenClaw Second Install</p>
      <h1>Faye Voice Control</h1>
      <p class="hero-lead">Always-on local voice orchestration with trust-first visibility and one-screen recovery actions.</p>

      <div class="hero-actions" aria-label="Quick actions">
        <button type="button" id="refresh-health" class="secondary">Refresh Status</button>
        <button type="button" id="restart-listener" class="secondary">Restart Listener</button>
        <button type="button" id="restart-bridge" class="secondary">Restart Bridge</button>
        <button type="button" id="test-voice">Test Voice</button>
      </div>

      <div id="service-summary" class="status-strip" aria-live="polite"></div>
    </header>

    <main class="layout" aria-live="polite">
      <section class="panel" aria-labelledby="setup-title">
        <h2 id="setup-title">Guided Setup</h2>
        <p class="panel-intro">Save your active profile once, then use quick actions above for daily checks and recovery.</p>

        <form id="setup-form" class="stack-form" novalidate>
          <div class="form-group">
            <h3>Identity</h3>
            <label>
              Profile Name
              <input id="setup-profile-name" name="profileName" data-setup-field="profileName" type="text" value="Primary Voice" required maxlength="80" />
              <small class="field-error" data-setup-error="profileName" aria-live="polite"></small>
            </label>
            <label>
              Wake Word
              <input id="setup-wake-word" name="wakeWord" data-setup-field="wakeWord" type="text" value="Faye Arise" required maxlength="120" />
              <small class="field-error" data-setup-error="wakeWord" aria-live="polite"></small>
            </label>
          </div>

          <div class="form-group">
            <h3>Voice Provider</h3>
            <label>
              ElevenLabs API Key
              <input id="setup-api-key" name="apiKey" data-setup-field="apiKey" type="password" autocomplete="off" maxlength="300" />
              <small class="field-error" data-setup-error="apiKey" aria-live="polite"></small>
            </label>
            <label>
              Voice ID
              <input id="setup-voice-id" name="voiceId" data-setup-field="voiceId" type="text" required maxlength="128" />
              <small class="field-error" data-setup-error="voiceId" aria-live="polite"></small>
            </label>
            <label>
              Voice Name
              <input id="setup-voice-name" name="voiceName" data-setup-field="voiceName" type="text" required maxlength="128" />
              <small class="field-error" data-setup-error="voiceName" aria-live="polite"></small>
            </label>
          </div>

          <div class="form-group">
            <h3>Optional Bridge</h3>
            <label>
              Telegram Bot Token (optional)
              <input id="setup-telegram-token" name="telegramToken" data-setup-field="telegramToken" type="password" autocomplete="off" maxlength="300" />
              <small class="field-error" data-setup-error="telegramToken" aria-live="polite"></small>
            </label>
            <label>
              Telegram Chat ID (optional)
              <input id="setup-telegram-chat-id" name="telegramChatId" data-setup-field="telegramChatId" type="text" maxlength="64" />
              <small class="field-error" data-setup-error="telegramChatId" aria-live="polite"></small>
            </label>
          </div>

          <div id="setup-validation-summary" class="validation-summary" role="alert" aria-live="polite"></div>

          <div class="actions">
            <button type="submit">Save Setup</button>
          </div>
        </form>

        <p id="setup-status" class="status"></p>
      </section>

      <section class="panel" aria-labelledby="first-success-title">
        <h2 id="first-success-title">First Success Checklist</h2>
        <p class="panel-intro">Talk to your agent in under 10 minutes by completing each readiness check.</p>
        <div id="first-success-checklist" class="first-success-box" aria-live="polite"></div>
      </section>

      <section class="panel" aria-labelledby="profiles-title">
        <h2 id="profiles-title">Voice Profiles</h2>
        <p class="panel-intro">Keep specialized profiles and swap instantly when tasks or environments change.</p>
        <div id="profile-list" class="profiles-grid"></div>

        <form id="create-profile-form" class="inline-form">
          <h3>Create Profile</h3>
          <label>Name<input name="name" type="text" required /></label>
          <label>Voice ID<input name="voiceId" type="text" required /></label>
          <label>Voice Name<input name="voiceName" type="text" required /></label>
          <label>Wake Word<input name="wakeWord" type="text" required /></label>
          <button type="submit">Create</button>
        </form>
      </section>

      <section class="panel" aria-labelledby="status-title">
        <h2 id="status-title">System Pulse</h2>
        <p class="panel-intro">A compressed operational readout for reliability, latency, and bridge behavior.</p>
        <div id="runtime-status" class="runtime-grid" aria-live="polite"></div>

        <details class="health-raw">
          <summary>Raw Health JSON</summary>
          <pre id="health" class="code-block"></pre>
        </details>
      </section>

      <section class="panel" aria-labelledby="conversation-title">
        <h2 id="conversation-title">Conversation Session</h2>
        <p class="panel-intro">Track active conversation progress, retained turns, and end the session if recovery is needed.</p>
        <div id="conversation-state" class="conversation-state" aria-live="polite"></div>
        <ul id="conversation-turns" class="conversation-turns" aria-live="polite"></ul>
        <div class="actions">
          <button type="button" id="conversation-end" class="danger">End Active Session</button>
        </div>
      </section>

      <section class="panel" aria-labelledby="events-title">
        <h2 id="events-title">Live Event Stream</h2>
        <p class="panel-intro">Recent event flow to debug wake, bridge, and spoken-response timing in real time.</p>
        <ul id="events" class="event-feed"></ul>
      </section>
    </main>

    <script type="module" src="/js/main.js"></script>
  </body>
</html>
